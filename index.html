<!doctype html>
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <script type="text/javascript">
  var t1 = new Date();
/* 
 * cached-webpgr.js - simple localStorage based caching of JavaScript files
 * https://github.com/webpgr/cached-webpgr.js
 * Author: Webpgr http://webpgr.com by Falko Krause <falko@webpgr.com>
 * License: MIT
 */

var dd=document;function _cacheScript(e,t,a,n,o){var c=new XMLHttpRequest;c.onreadystatechange=function(){4==c.readyState&&(200==c.status?(localStorage.setItem(e,JSON.stringify({content:c.responseText,version:t})),_injectScript(e,t,a,n,o)):o&&o())},c.open("GET",a,!0),c.send()}function _loadScript(e,t,a,n,o){var c=n?dd.createElement("script"):dd.createElement("style");c.readyState?c.onreadystatechange=function(){console.log("s.onreadystatechange"),"loaded"!=c.readyState&&"complete"!=c.readyState||(c.onreadystatechange=null,o&&o())}:(console.log("s.onload"),c.onload=function(){o&&o()}),c.setAttribute("src",a),dd.getElementsByTagName("head")[0].appendChild(c)}function _injectScript(e,t,a,n,o){var c,r=JSON.parse(localStorage.getItem(e));if(r.version!=t)return localStorage.removeItem(e),void _cacheScript(e,t,a,n,o);c=n?dd.createElement("style"):dd.createElement("script");var d=dd.createTextNode(r.content);c.appendChild(d),dd.getElementsByTagName("head")[0].appendChild(c),o&&o()}function requireScript(e,t,a,n,o){"undefined"==typeof localStorage?(console.log("localStorage"),_loadScript(e,t,a,n,o)):(null==localStorage.getItem(e)?_cacheScript:_injectScript)(e,t,a,n,o)}
  // ---
  
  requireScript('jquery', '1.11.5', 'http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js', function(){
    requireScript('examplejs', '0.0.5', 'example.js');
  });

  </script>
</head>
<body>
  <h1>localStorage Script Caching Demo</h1>
  <p>This code demonstrates how to use the localStorage to cache and JavaScrip files. <br>
  Cached files will be loaded much faster than scripts from any server (even local ones). <br>
  My test showed:
  <table>
    <tbody>
      <tr>
        <td>Loading jQuery from CDN</td>
        <th>268ms</th>
      </tr>
      <tr>
        <td>Loading jQuery from localStorage</td>
        <th>47ms</th>
      </tr>
    </tbody>
  </table>
  <br>
  <sub>
    This demo will only work on a server, file:// is not supported.
  </sub>
  </p>
</body>
</html>
